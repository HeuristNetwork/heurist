<html>
 <head>
  <title>Flexible Export v 1.04 </title>

  <!--
   This HAPI tool is designed to export multiple details for a selected resource
   type. For REFERENCE it is designed to export a key detail for the refernced record
   type. It is written generically to allow any HRecordType and HDetailType
   REFERENCE between any 2 HRecords.  The tool reads the record types from Heurist
   and requires the user to select the HDetailTypes to export and if any of the
   HDetailTypes are REFERENCE the user is requested to select the output HDetail for
   the REFERENCE object. The user is allowed to select the delimiters for the output
   data which is output to a textarea for cut and paste. Multivalued fields are delimited
   with a vertical bar (|).
  -->

  <script src="../../common/php/load-hapi.php"></script>
  <script>
      if (!(HCurrentUser.isLoggedIn()&& HCurrentUser.isAdministrator())) window.location =  HAPI.HeuristBaseURL + "common/connect/login.php";
  </script>

  <script src="flexport.js"></script>

  <style>
	#csv-textarea {
		width: 100%;
		height: 400px;
		border: 2px solid black;
	}
	#csv-separator, #csv-terminator { width: 30px; }
	table { border-collapse: collapse; }
	td { width: 100px; border: 1px solid gray; padding: 2px; }
	td select { width: 100px; }
	td.error { color: red; }
	#col-select-row td { border: none; padding: 1px 5px 5px 0px; vertical-align: top; }
  </style>
 </head>

 <body onload = "getRecTypes();">
  <h2>Record Data Export Tool</h2>
  <p id=info-p></p>
  <p id=select-rec-type></p>
  <div id=select-detail-type></div>
  <div id=export-detail-map></div>
  <div id="results"></div>
  <p id=records-p></p>
 </body>
</html>
