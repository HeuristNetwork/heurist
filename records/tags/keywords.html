<html>
 <head>
  <link rel=stylesheet href="../../common/css/heurist.css">
  <link rel=stylesheet href="../../common/css/keyword-editor.css">

  <title>Workgroup tags</title>
 </head>
 <body width=700 height=600>
  <script src="../../common/js/heurist.js"></script>
  <script src="../../common/php/display-preferences.php"></script>
  <script src=keyword-editor.js></script>

    <table><tr>
	 <td style="font-size: 150%; font-weight: bold; vertical-align: top;"><nobr>Workgroup tags &nbsp;&nbsp;</nobr></td>
	 <td style="font-size: 11px;">
      Tags are a controlled list of terms assigned by the workgroup adminstrators.
      Only members of a workgroup can add or delete the tags for that workgroup.
      Visit the workgroup home page (Workgroups menu on the Heurist search screen)
      to email the workgroup adminstrators.
     </td>
    </tr></table>

    <table border=0 cellspacing=0 cellpadding=0 style="margin: 10px 40px;">
     <tr>
      <td><b>Available</b></td>
      <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
      <td><b>Selected</b></td>
     </tr>

     <tr>
      <td>
       <div class=keyword-list><table border=0 cellspacing=0 cellpadding=0><tbody id=all-workgroup-tags></tbody></table></div>
      </td>
      <td>
       <div id=button-box>
        <div><input type=button value="&gt;" title="Add a tag" onmousedown="HEURIST.keywordEditor.addWgTag(window.selectedRow)" disabled id=add-button></div>
        <div>&nbsp;&nbsp;</div>
        <div><input type=button value="&lt;" title="Remove a tag" onmousedown="HEURIST.keywordEditor.removeWgTag(window.selectedRow)" disabled id=remove-button></div>
       </div>
      </td>
      <td>
       <div class=keyword-list><table border=0 cellspacing=0 cellpadding=0><tbody id=current-workgroup-tags></tbody></table></div>
      </td>
     </tr>

     <tr class=help>
      <td style="font-size: 11px;" >Double-click on a tag to select it</td>
      <td>&nbsp;&nbsp;</td>
      <td class=prompt>&nbsp;<!-- i have nothing sensible to say here --></td>
     </tr>

    <tr>
     <td>
      <a href="../../admin/workgroups/workgroup_keyword_manager.php" target="blank">Modify Tag Definitions (admins only) </a>
      <div style="font-size: 11px; ">Reload edit form to see new tags</div>
     </td>
     <td></td>
     <td>
      <input type=button onclick="saveKeywords(true)" value="Add">
	  these tags to all selected records
	  <br>
	  <br>
	  <hr>
	  <br>
      <input type=button onclick="saveKeywords(false)" value="Remove">
	  these tags from all selected records
     </td>
    </tr>

    </table>

    <!-- not used in this form ... just for compatibility with the edit/workgroups tab ... safe to FIXME when we refactor -->
    <form id=keyword-form jsonAction="update-taglinks.php" action="update-taglinks.php"></form>

<script>

var removeButton = document.getElementById("remove-button");
var addButton = document.getElementById("add-button");

var currWgTagsElt = document.getElementById("current-workgroup-tags");
var allWgTagsElt = document.getElementById("all-workgroup-tags");
new HEURIST.keywordEditor.KeywordEditor(currWgTagsElt, allWgTagsElt, addButton, removeButton);


function saveKeywords(add) {
	// grab the IDs of the workgroup tags that we are adding, pass them back to the close function.
	var ids = [];
	for (var i=0; i < currWgTagsElt.childNodes.length; ++i) {
		var id = parseInt(currWgTagsElt.childNodes[i].id);
		ids.push(id);
	}

	if (! add  &&  ids.length > 0  &&  ! confirm("Are you sure you wish to remove these tags from the selected records?")) return;

	window.close(add, ids);
}

</script>
   </div>

 </body>
</html>
