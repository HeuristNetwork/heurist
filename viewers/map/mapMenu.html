<!--

/**
* mapMenu.html
*
* @version 2011.0615
* @author: Artem Osmakov
*
* @copyright (C) 2005-2011 University of Sydney Digital Innovation Unit.
* @link: http://HeuristScholar.org
* @license http://www.gnu.org/licenses/gpl-3.0.txt
* @package Heurist academic knowledge management system
* @todo
**/

-->
<html>

<head>
 <link rel="stylesheet" href="../../common/css/global.css">
 <title>Map search results</title>
 <script>

   function build_links() {
     if (top.HEURIST  && top.HEURIST.search)
     {

/*
			var p = top.HEURIST.parameters;

			var db = p['db'] ? p['db'] :
					(top.HEURIST.database && top.HEURIST.database.name ? top.HEURIST.database.name : "");

			var query_string = 'ver='+(p['ver'] || "") +
									'&w='+(p['w'] || "") +
									'&stype='+(p['stype'] || "") +
									'&db='+(p['db'] || "") +
									'&limit='+top.HEURIST.search.resultsPerPage;

			if(top.HEURIST.search.currentPage>0){
				query_string = query_string + '&offset=' +
					top.HEURIST.search.currentPage*top.HEURIST.search.resultsPerPage;
			}


     		query_string = encodeURI(query_string);
*/
			var mode = top.HEURIST.displayPreferences["showSelectedOnlyOnMapAndSmarty"];
	 		var currentSearchQuery =
	 				(mode=="selected")
						?top.HEURIST.currentQuery_sel  //top.HEURIST.search.currentSearchQuery_sel
						:((mode=="all")?top.HEURIST.currentQuery_all:top.HEURIST.currentQuery_main);

			if(currentSearchQuery)
			{

	 		var url = top.HEURIST.baseURL+"viewers/map/showMapS.html?" + currentSearchQuery;

			document.getElementById("linkTimeline").href = url;

     		document.getElementById("code-textbox").value = '<iframe src="' + url + '" width="800" height="650" frameborder="0"></iframe>';

	 		var url_kml = top.HEURIST.baseURL+"export/xml/kml.php?" + currentSearchQuery;

			document.getElementById("linkKml").href = url_kml;

	 		}
	 }
   }
 </script>
</head>

<body onLoad="build_links()" width=600 height=450 class="popup">

<p>
 Note: records will only appear on the map if they include geographic objects.
 You may get an empty or sparsely populated map if the search results do not
 contain map data. <br>&nbsp;
</p>



<p><img src="../../common/images/google-earth-logo.gif" align="middle"> &nbsp; &nbsp;
<a id="linkKml" href="#" target=_new onClick="setTimeout(window.close, 1000)"><b>Google Earth</b></a></p>

<img src="../../common/images/google-maps-logo.gif" align="middle"> &nbsp; &nbsp;
<a href="#" id="linkTimeline" target=_new onClick="setTimeout(window.close, 200);"><b>Google Map + Timeline</b></a>

<p>
<blockquote>
   Embed this Google Map (plus timeline) in your own web page:
   Copy the following html code into your page where you want to place the map,
   or use the URL on its own. The map will be generated live from the database
   using the current search criteria whenever the map is loaded.
   <br>
   <br>
  <textarea readonly style="border: 1px dotted gray; padding: 3px; margin: 2; font-family: times; font-size: 10px; width: 100%; height: 60px;"
    id=code-textbox onClick="select(); if (window.clipboardData) clipboardData.setData('Text', value);"></textarea>
</blockquote>



</body>
</html>