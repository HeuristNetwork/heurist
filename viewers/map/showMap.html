<!--

/**
* showMap.html
* Timemap = Mapstraction+Timeline
*
* @version 2011.0615
* @author: Artem Osmakov
*
* @copyright (C) 2005-2011 University of Sydney Digital Innovation Unit.
* @link: http://HeuristScholar.org
* @license http://www.gnu.org/licenses/gpl-3.0.txt
* @package Heurist academic knowledge management system
* @todo
**/

-->
<html>
<head>

<meta http-equiv="content-type" content="text/html; charset=utf-8">
<title></title>

<!-- yui layout -->

<link rel="stylesheet" type="text/css" href="../../external/yui/2.8.2r1/build/reset-fonts-grids/reset-fonts-grids.css">
<!-- Skin CSS files resize.css must load before layout.css -->
<link rel="stylesheet" type="text/css" href="../../external/yui/2.8.2r1/build/assets/skins/sam/resize.css">
<link rel="stylesheet" type="text/css" href="../../external/yui/2.8.2r1/build/assets/skins/sam/layout.css">
<!-- Utility Dependencies -->
<script src="../../external/yui/2.8.2r1/build/yahoo-dom-event/yahoo-dom-event.js"></script>
<script src="../../external/yui/2.8.2r1/build/dragdrop/dragdrop-min.js"></script>
<script src="../../external/yui/2.8.2r1/build/element/element-min.js"></script>
<!-- Optional Animation Support
<script src="../../external/yui/2.8.2r1/build/animation/animation-min.js"></script> -->
<!-- Optional Resize Support -->
<script src="../../external/yui/2.8.2r1/build/resize/resize-min.js"></script>
<!-- Source file for the Layout Manager -->
<script src="../../external/yui/2.8.2r1/build/layout/layout-min.js"></script>


<!-- timemap/timeline scripts -->

	<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>

	<script type="text/javascript">
			RelBrowser = {
						//baseURL: "http://heuristscholar.org/h3-ao/",
						pipelineBaseURL: "../"
			};

	//Timeline_urlPrefix = RelBrowser.baseURL + "external/timemap.2.0/lib/";
//	Timeline_urlPrefix = "http://heuristscholar.org/h3-ao/external/timemap.2.0/lib/timeline/";
//	Timeline_ajax_url = "http://heuristscholar.org/h3-ao/external/timemap.2.0/lib/timeline/timeline_ajax/simile-ajax-api.js";

	Timeline_urlPrefix = "../../external/timemap.2.0/lib/timeline/";
	Timeline_ajax_url = "../../external/timemap.2.0/lib/timeline/timeline_ajax/simile-ajax-api.js";

/*      Timeline_ajax_url   = RelBrowser.baseURL + "external/timeline_2.3.0/timeline_ajax/simile-ajax-api.js";
      Timeline_urlPrefix  = RelBrowser.baseURL + "external/timeline_2.3.0/timeline_js/";
      Timeline_parameters = 'bundle=true'; */

			var showMap, HRST;
	</script>

<link href="../../external/jquery/jquery-ui-1.8.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../external/jquery/jquery-1.5.1.min.js"></script>
<script type="text/javascript" src="../../external/jquery/jquery-ui-1.8.13.custom.min.js"></script>

<!-- <script type="text/javascript" src="../../external/timemap.2.0/lib/jquery-1.4.4.min.js"></script> -->
<script type="text/javascript" src="../../external/timemap.2.0/lib/mxn/mxn.js?(googlev3)"></script>

<script type="text/javascript" src="../../external/timemap.2.0/lib/markerclusterer.js"></script>
<!--
<script type="text/javascript" src="../../external/timemap.2.0/lib/timeline-2.3.0.js"></script>
<script type="text/javascript" src="../../external/timemap.2.0/lib/timeline-1.2.js"></script>

<script type="text/javascript" src="../../external/timemap.2.0/lib/timeline-2.3.0.js"></script>
-->
<script type="text/javascript" src="../../external/timemap.2.0/lib/timeline/timeline-api.js?bundle=true"></script>

<script src="../../external/timemap.2.0/src/timemap.js" type="text/javascript"></script>
<script src="../../external/timemap.2.0/src/param.js" type="text/javascript"></script>
<script src="../../external/timemap.2.0/src/manipulation.js" type="text/javascript"></script>
<script src="../../external/timemap.2.0/src/loaders/xml.js" type="text/javascript"></script>
<script src="../../external/timemap.2.0/src/loaders/kml.js" type="text/javascript"></script>

<script src="../../viewers/map/mapping.js" type="text/javascript"></script>
<script src="../../common/js/temporalObjectLibrary.js" type="text/javascript"></script>


<!--
<link rel=stylesheet href="../../common/css/global.css" media="all">
<script src="{$urlbase}js/gmapimage.js" type="text/javascript"/>
-->
<style type="text/css">
body {
	font: 10px Verdana, Geneva, sans-serif;
}
#map {
	margin-bottom: 8px;
	overflow: hidden;
	border: 1px solid #320a0a;
}
#map.image {
	height: 512px;
	margin-bottom: 17px;
}
#map.full {
	height: 100%;
}
#map.entity-map {
	height: 180px;
}
#map.hide {
	display: none;
}
.map-description {
	margin-bottom: 20px;
}

#timeline {
	border: 1px solid #320a0a;
	overflow-x:hidden;
	overflow-y:auto;
}

#timeline-zoom {
	position: absolute;
	top: 3px;
	left: 3px;
	z-index: 2000;
	visibility: visible;
}
#timeline-zoom div {
	cursor: pointer;
}
#timeline.hide, #timeline-zoom.hide {
	position: absolute;
	visibility: hidden;
}

#timeline.entity-timeline .timeline-event-icon,
#timeline.entity-timeline .timeline-event-label,
#timeline.entity-timeline .timeline-event-tape {
	cursor: default;
}

#rec_popup{
	color:green;
	display:inline-block;
	text-align:left;
	padding-left:3px;
	padding-top:3px;
}

.popup_body{
	color:green;
	text-align:left;
}


/* for transparency slider*/
.ui-slider .ui-slider-handle {width: 0.25em;height:0.75em;}
.ui-slider-horizontal .ui-slider-handle {
  						margin-left: -0.3em;
    					top: -0.3em;
}
#mapButton {
	background-image: url("../../common/images/b_Map.png");
	background-position: 2px 2px;
	background-repeat: no-repeat;
	padding: 0 5px 0 26px !important;
	white-space: nowrap;
	margin:3px;
	float:right;
	border: none;
}
button {height:auto !important;
	text-transform: uppercase !important;
	display:inline-block !important;
	color: #666;
	cursor: pointer !important;
	font-weight:bold !important;
	background-color:transparent !important;
	border:1px solid RGBA(0,0,0,0.2) !important;
	-moz-border-radius:3px !important;
	-webkit-border-radius:3px !important ;
	border-radius:3px !important;
	padding:0 3px !important ;
	height:20px !important ;
	line-height:13px !important;
	font: 10px arial,helvetica,clean,sans-serif;
}
.button:hover, button:hover, input[type="button"]:hover {
	background-color:RGBA(0,0,0,0.1) !important;
	border:1px solid RGBA(0,0,0,0.4) !important;
	box-shadow: 0 1px 2px RGBA(0,0,0,0.4) inset !important;
	text-decoration:none !important;
	color:#000 !important;
}


#errorMsg{
	width:100%;
	height:99%;
	background-color:#FFF;
	text-align:center;
	vertical-align: middle;
}
#errorMsg span, .errorMsg span, div#errorMsg span{
	background-color: rgba(100, 100, 100, 0.6);
	background:-moz-linear-gradient(center top , rgba(100, 100, 100, 0.6), rgba(100, 100, 100, 0.9)) repeat scroll 0 0 transparent;
	background:-webkit-gradient(linear, left top, left bottom, from(rgba(100, 100, 100, 0.6)), to(rgba(100, 100, 100, 0.9)));
	border: 1px solid #999;
	-moz-border-radius:3px;
	-webkit-border-radius:3px;
	border-radius:3px;
	padding:3px;
	font-size:14px;
	color:#FFF;
}

.wrap {
	display:table;
	width:100%;
	height:100%;
	-webkit-border-bottom-right-radius:5px;
	border-bottom-right-radius: 5px;
	-moz-border-radius-bottomright:5px;
	margin:6px;
}
.wrap div {
	display:table-cell;
}
.wrap div iframe{
	width:100%;
	height:99%;
	border:0;
}

</style>

</head>

<body class="yui-skin-sam">

		<script type="text/javascript">
		 	HRST = top.HEURIST;
		</script>
		<script type="text/javascript" src="../../common/js/utilsLoad.js"></script>
		<script type="text/javascript" src="../../common/js/utilsUI.js"></script>
		<script type="text/javascript" src="../../viewers/map/showMap.js"></script>

		<script type="text/javascript">

// http://heuristscholar.org/h3-ao/viewers/map/showMap.html?ver=1&w=all&q=ids:145255&stype=&db=sandpit5
// http://heuristscholar.org/h3-ao/viewers/map/showGMapWithTimeline.html?ver=1&w=all&q=ids:97024&stype=&db=sandpit5
// http://heuristscholar.org/h3-ao/viewers/map/showMap.html?ver=1&w=all&q=ids:97024&stype=&db=sandpit5
// http://heuristscholar.org/h3-ao/viewers/map/showMap.html?ver=1&w=all&q=ids:97024,94594,69612,70316,123167&stype=&db=sandpit5
/*
			if(!top.HEURIST) { top.HEURIST = {}; }

			var _url = location.pathname.replace(/\/[^\/]*$/,"/")+'getMapDataFromQuery.php'+location.search;

			//top.HEURIST.loadScript(_url, true);
			Hul.loadScript2(this.document, _url);
*/
		</script>

		<div id="toolbarcontainer">
				<div id="toolbardiv">
					<div style="padding:5px;display:inline-block;">
<!--  Ian's request to change to checkbox
							<input type="radio" style="display:inline-block;"
								id="rbMapUseAllRecords" name="showmapmode" value="0"
								onChange="showMap.setUseAllRecords(event)">
							<label>Show all</label>
							<input type="radio" style="display:inline-block;"
								id="rbMapUseSelectedRecords" name="showmapmode" value="1"
								 onChange="showMap.setUseAllRecords(event)">
							<label>Selected only</label>
-->
							<input type="checkbox" style="display:inline-block;"
								id="rbMapUseSelectedRecords" name="showmapmode" value="1"
								 onChange="showMap.setUseAllRecords(event)">
							<label>Selected only</label>
					</div>
					<label>Background:</label>
					<select id="cbLayers" style="display:inline-block;" onchange="showMap.loadLayer(event)"></select>
					<!--
					<a name="auto-popup" class="small" href="../../viewers/map/mapMenu.html" Title="Map Search Results"><div id="mapButton" class="button">Publish Map</div></a>
					-->
					<button id="mapButton" onclick="publishMap()" Title="Map Search Results">Publish Map</button>
				</div>
		</div>

		<div id="mapcontainer">
				<div id="map" class="full"></div>
		</div>

		<div id="timelinecontainer" style="height:100%;overflow-y:auto;">
				<div id="timeline"></div>
				<div id="timeline-zoom"></div>
		</div>

		<div id="mapreportcontainer">
		</div>

<script type="text/javascript">

	//
	//  starts initialization on load completion of this window
	function loadHandler(){

		HRST = top.HEURIST; //alias that are in use in showMap.js

		RelBrowser.baseURL = HRST.basePath;
		RelBrowser.iconBaseURL =  HRST.iconBaseURL;
		RelBrowser.database = HRST.database.name;

		//Timeline.urlPrefix = HRST.baseURL + "external/timemap.2.0/lib/timeline/"; //"external/timemap.2.0/lib/";
		//Timeline.urlPrefix = HRST.baseURL + "external/timemap.2.0/lib/";

		window.showMap = new ShowMap();
	}

	//
	//
	function publishMap(){
		if(window.showMap && !window.showMap.isEmpty()){
			Hul.popupURL(this,'../viewers/map/mapMenu.html',null);
		}
	}

	YAHOO.util.Event.addListener(window, "load", loadHandler );

</script>

</body>
</html>
